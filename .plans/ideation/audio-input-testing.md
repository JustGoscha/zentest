# Audio input testing (Playwright fake devices)

Goal: enable deterministic audio input in Zentest by feeding a WAV file
through Chromium's fake media stream so agentic and static tests can
exercise mic flows.

Scope:
- Chromium only. Skip WebKit/Firefox for first iteration.
- Headless and headed support.

Plan:
1) Config + CLI
   - Add config fields:
     - `audioInput.enabled` (boolean, default false)
     - `audioInput.file` (absolute or project-relative path to WAV)
   - Map CLI flags:
     - `--audio-input`
     - `--audio-file <path>`
   - Resolve to absolute path at runtime and validate file exists.

2) Browser launch options
   - Pass Chromium args:
     - `--use-fake-device-for-media-stream`
     - `--use-file-for-fake-audio-capture=<abs-wav-path>`
   - Keep existing headless behavior.

3) Permissions
   - Auto-grant `microphone` permission for the target origin.
   - Ensure permissions apply to both agentic runs and static runs.

4) Test artifacts
   - Copy the WAV into run artifacts when `audioInput.enabled` is true
     for debugging reproducibility.

5) Documentation
   - Update `zentest/README.md` with usage examples.
   - Add constraints and supported formats (WAV 16-bit PCM).

6) Error handling
   - Fail fast with a clear error if:
     - File not found
     - Non-Chromium browser
     - Unsupported format

Acceptance:
- A mic-based flow can be tested in a Playwright test generated by
  Zentest without manual interaction.
- Tests are deterministic given the same WAV file.
